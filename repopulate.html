<!DOCTYPE html>
<html>
<head>
<script type="text/javascript" src="Repopulate.js"></script>
<script type="text/javascript" src="EventEmitter.js"></script>
</head>
<body>


<select id="country" data-child="#admin1, #admin11">
    <option value="">Seleccione país</option>
    <option value="es">España</option>
    <option value="au">Australia</option>
</select>


<select id="admin1" data-child="#admin2"
        data-url="{{ path('cave_backend_json_admin1') }}"
        data-querykey="countryid"
        data-returnformat="text,id"
        data-emptyOption="Seleccione admin1"
        data-parameters='{"paramkey":"paramvalue"}'
></select>

<select id="admin11"
        data-url="{{ path('cave_backend_json_admin1') }}"
        data-querykey="countryid"
        data-returnformat="text,id"
        data-emptyOption="Seleccione admin1"
        data-parameters='{"param1key":"param1value"}'
></select>



<select id="admin2" data-child="#admin3, #admin31, #admin32"
        data-url="{{ path('cave_backend_json_admin2') }}"
        data-querykey="admin1id"
        data-returnformat="text,id"
        data-emptyOption="Seleccione admin2"
></select>

<select id="admin3"
        data-url="{{ path('cave_backend_json_admin3') }}"
        data-querykey="admin2id"
        data-returnformat="text,id"
        data-emptyOption="Seleccione admin3"
></select>

<select id="admin31"
        data-url="{{ path('cave_backend_json_admin3') }}"
        data-querykey="admin2id"
        data-returnformat="text,id"
        data-emptyOption="Seleccione admin3"
></select>
<select id="admin32"
        data-url="{{ path('cave_backend_json_admin3') }}"
        data-querykey="admin2id"
        data-returnformat="text,id"
        data-emptyOption="Seleccione admin3"
></select>

</body>
    <script>
            let repo = new Repopulate('#country');
            repo.on('ev.onLoadResponse', (data, el, attr)=>{
                return JSON.parse(data.response).out;//return part of response
            });
            repo.xhr_method='GET';
            repo.bindAll();
    </script>
    
</html>
